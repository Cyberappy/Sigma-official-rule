title: Detection of PowerShell Execution via SQL (SQLPS.exe) 
id: 1216f0a1-9e10-4250-8c7d-4d4a8d05ba0d 
status: experimental
description: PowerShell execution through builtin SQL Server "SQLPS.exe" binary.
references:
  - https://twitter.com/pabraeken/status/993298228840992768
  - https://docs.microsoft.com/en-us/sql/tools/sqlps-utility?view=sql-server-ver15 
tags:
    - attack.execution
    - attack.t1059.011
author: Agro (@agro_sev)
date: 2020/10/10
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith: '\sqlps.exe'
    condition: selection
falsepositives:
    - Direct PS command execution through SQLPS.exe is uncommon.
level: medium 
