title: PowerShell AADInternals Tenant Information and Manipulation
id: 222f2d70-a84b-44db-97fe-c7ca08a09e91
status: experimental
description: Detects ADDInternals tool is being used for administering or hacking Azure AD and Office 365. Information functions are functions that can be used to retrieve information about users, tenants, and Office 365. Functions marked with * doesnâ€™t need authentication.
references:
    - https://o365blog.com/aadinternals/
    - https://github.com/Gerenios/AADInternals
author: Austin Songer (@austinsonger)
date: 2021/10/29
logsource:
    product: windows
    category: ps_script
    definition: Script Block Logging must be enable
detection:
    selection:
        ScriptBlockText|contains:
            - "Get-AADIntLoginInformation"
            - "Get-AADIntEndpointInstances"
            - "Get-AADIntEndpointIps"
            - "Get-AADIntTenantDetails"
            - "Get-AADIntTenantID"
            - "Get-AADIntOpenIDConfiguration"
            - "Get-AADIntServiceLocations"
            - "Get-AADIntServicePlans"
            - "Get-AADIntServicePrincipals"
            - "Get-AADIntSubscriptions"
            - "Get-AADIntSPOServiceInformation"
            - "Get-AADIntCompanyInformation"
            - "Get-AADIntCompanyTags"
            - "Get-AADIntAADConnectStatus"
            - "Get-AADIntSyncConfiguration"
            - "Get-AADIntTenantDomains"
            - "Get-AADIntKerberosDomainSyncConfig"
            - "Get-AADIntWindowsCredentialsSyncConfig"
            - "Get-AADIntSyncDeviceConfiguration"
            - "Get-AADIntTenantAuthPolicy"
            - "Get-AADIntTenantGuestAccess"
            - "Set-AADIntTenantGuestAccess"
            - "Enable-AADIntTenantMsolAccess"
            - "Disable-AADIntTenantMsolAccess"
            - "Get-AADIntUnifiedAuditLogSettings"
            - "Set-AADIntUnifiedAuditLogSettings"
            - "Get-AADIntComplianceAPICookies"
            - "Search-AADIntUnifiedAuditLog"
            - "Get-AADIntConditionalAccessPolicies"
            - "Get-AADIntSelfServicePurchaseProducts"
            - "Set-AADIntSelfServicePurchaseProduct"
    condition: selection
tags:
    - attack.execution
    - attack.reconnaissance
    - attack.discovery
    - attack.credential_access
    - attack.impact
falsepositives:
    - Penetration testing
level: high
