title: CVE-2023-22518 Exploitation Attempt - Vulnerable Endpoint Connection
id: a902d249-9b9c-4dc4-8fd0-fbe528ef965c 
status: experimental
description: Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g. create admin accounts and execute arbitrary commands.
references:
    - https://confluence.atlassian.com/security/cve-2023-22518-improper-authorization-vulnerability-in-confluence-data-center-and-server-1311473907.html
    - https://www.huntress.com/blog/confluence-to-cerber-exploitation-of-cve-2023-22518-for-ransomware-deployment
    - https://github.com/ForceFledgling/CVE-2023-22518
author: Andreas Braathen (mnemonic.io)
date: 2023/11/14
tags:
    - detection.emerging_threats
    - attack.initial_access
    - attack.t1190
    - cve.2023.22518
logsource:
    category: webserver # Can also be WAF/Proxy
    definition: 'Requirements: In order for this detection to trigger, access logs must be collected.'
detection:
    selection_method:
        cs-method: 'POST'
    selection_uris:
        c-uri|contains: 
          # Exploitable endpoints
          - '/json/setup-restore.action'
          - '/json/setup-restore-local.action'
          - '/json/setup-restore-progress.action'
          - '/server-info.action'
          - '/setup/setupadministrator.action'
    selection_status:
        # Response code may be indicative of exploitation success, but is not always the case
        sc-status: 
          - 200
          - 302
          - 405
    condition: all of selection_*
falsepositives:
    - Vulnerability scanners
level: medium
