title: Detection of CVE-2023-46214 POC Upload Of Shell
id: ba5268de-4dd4-4d5c-8a90-2b5e6dc1aff8
status: experimental
description: This rule is based on the POC by nathan31337, and search for explotation of CVE-2023-46214
references:
    - https://github.com/nathan31337/Splunk-RCE-poc/tree/main
    - https://nvd.nist.gov/vuln/detail/CVE-2023-46214
author: Lars B. P. Frydenskov(Trifork Security)
date: 2023/11/19
tags:
    - cve.2023.46214
    - detection.emerging_threats
    - attack.lateral_movement
    - attack.t1210
logsource:
    category: webserver
detection:
    selection_method:
        cs-method: POST
    selection_uris:
        cs-uri-query|contains:
            - /splunkd/__upload/indexing/preview\?output_mode=json&props.NO_BINARY_CHECK=1&input.path=shell.xsl
        cs-uri-query|contains|all:
            - /api/search/jobs/
            - /results\?xsl=/opt/splunk/var/run/splunk/dispatch/
            - /shell.xsl
    selection_status:
        sc-status:
            - 200
            - 302
    condition: all of selection_*
falsepositives:
    - 'Very unlikely due the nature of the detection, matching on the ''shell.xsl'' file name. '
level: high
